<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.axing.reggie.mapper.OrdersMapper">

    <insert id="save">
        insert into orders values (
                                    #{id},
                                    #{number},
                                    #{status},
                                    #{userId},
                                    #{addressBookId},
                                    #{orderTime},
                                    #{checkoutTime},
                                    #{payMethod},
                                    #{amount},
                                    #{remark},
                                    #{phone},
                                    #{address},
                                    #{userName},
                                    #{consignee}
                                  )
    </insert>

    <update id="updateOrderStatusById">
        update orders set status=#{status} where id=#{id}
    </update>

    <select id="getOrdersByUserId" resultType="com.axing.reggie.dto.OrdersDto">
        select * from orders
            <where>
                <if test="userId != null and userId != ''">
                    user_id=#{userId}
                </if>
                <if test="number != null and number != ''">
                    and number like '%' #{number} '%'
                </if>
                <if test="beginTime != null and beginTime != ''">
                    and order_time between #{beginTime} and #{endTime}
                </if>
            </where>
        order by order_time desc
        limit #{startNum},#{pageSize}
    </select>

    <select id="getOrdersById" resultType="com.axing.reggie.dto.OrdersDto">
        select * from orders where id=#{id}
    </select>

    <select id="getTotal" resultType="java.lang.Integer">
        select count(*) from orders
        <where>
            <if test="userId != null and userId != ''">
                user_id=#{userId}
            </if>
            <if test="number != null and number != ''">
                and number like '%' #{number} '%'
            </if>
            <if test="beginTime != null and beginTime != ''">
                and order_time between #{beginTime} and #{endTime}
            </if>
        </where>
    </select>

</mapper>
